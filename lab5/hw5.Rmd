---
title: "Homework 5"
author: "Alejandro Acevedo"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: spacelab
---

## Instructions
Answer the following questions and/or complete the exercises in RMarkdown. Please embed all of your code and push the final work to your repository. Your report should be organized, clean, and run free from errors. Remember, you must remove the `#` for any included code chunks to run. Any plots must have appropriate titles and aesthetics.  

## Load the tidyverse
```{r}
library("tidyverse")
options(scipen=999) #turn off scientific notation
```

## Data
**Database of vertebrate home range sizes.** 
Reference: Tamburello N, Cote IM, Dulvy NK (2015) Energy and the scaling of animal space use. The American Naturalist 186(2):196-211. http://dx.doi.org/10.1086/682070.  
Data: http://datadryad.org/resource/doi:10.5061/dryad.q5j65/1  

**1. Load the data into a new object called `homerange`.**
```{r}
homerange <- read_csv("data/Tamburelloetal_HomeRangeDatabase.csv")
```

**2. What is the structure of the `homerange` data? Does it have any NA's? Do a quick exploratory analysis of your choice below.**
```{r}
glimpse(homerange)
#Homerange has several NA's mostly under alternative mass references, where it can be pressumed the creator could not find more studies as well as preymass NA's that one can assume is for herbivores that don't have prey since they eat plants.
```

```{r}
names(homerange)
```

**3. Which animal groups are represented in the data? Make a plot that shows the number in each class.**
```{r}
ggplot(data=homerange, 
       mapping = aes(x=taxon))+
  geom_bar(mapping=aes(fill=taxon))
  #Birds, Mammals, Reptiles and Fish of various aquatic settings are included in the data
```

**4. Are there more carnivores or herbivores represented in the data? Make a plot that shows the number in each trophic guild.**
```{r}
ggplot(homerange,
       mapping=aes(x=trophic.guild))+
  geom_bar(mapping=aes(fill=trophic.guild))
 #More Carnivores than Herbivores are in the data set
```

**5. Which herbivorous mammals have homeranges greater than 1,000,000 mÂ²? Show only the common name, order, mean homerange size, and mean body mass. Arrange the data in descending order by homerange size and show only the top 10 species.**
```{r}
names(homerange)
```
```{r}
homerange %>% 
  select(trophic.guild, common.name, order, mean.hra.m2, mean.mass.g) %>% 
  filter(trophic.guild=="herbivore") %>% 
  filter(mean.hra.m2 >=1000000) %>% 
  slice_max(mean.hra.m2, n=10) %>% 
  arrange(desc(mean.hra.m2))
```

**6. Which two species have the largest and smallest homerange sizes?**
```{r}
homerange %>% 
  select(species, mean.hra.m2) %>% 
  slice_max(mean.hra.m2, n=1) 
  
 
```

```{r}
homerange %>% 
 select(species, mean.hra.m2) %>% 
 slice_min(mean.hra.m2, n=1)
```


**7. Which carnivorous mammals have the largest homeranges?**
```{r}
names(homerange)
```


```{r}
homerange %>% 
  select(trophic.guild, common.name, taxon, mean.hra.m2) %>% 
  filter(trophic.guild=="carnivore") %>% 
  filter(taxon=="mammals") %>% 
  slice_max(mean.hra.m2, n=10)
 
```

**8. Is there a relationship between body mass and homerange size? Make a scatterplot to show this relationship. Be sure to include appropriate labels and a title.**
```{r}
names(homerange)
```


```{r}
 ggplot(data=homerange,
        mapping=aes(x=mean.mass.g, y=mean.hra.m2)) +
  geom_point()+
  geom_smooth(method=lm, se=T)+
  scale_y_log10()+
  scale_x_log10()+
  labs(title="Average Body Mass of Species vs Average Homerange Size")

 #Larger animals tend to have larger Homeranges
```

**9. Use filter to extract the data for only birds and mammals. Then make a plot that compares the homerange sizes of these two groups. Be sure to include appropriate labels and a title.**
```{r}
names(homerange)
```

```{r}
 homerange %>% 
  filter(taxon=="mammals"| taxon=="birds") %>% 
 ggplot(mapping=aes(x=taxon, y=mean.hra.m2)) +
  geom_boxplot(mapping=aes(fill=taxon))+
  scale_y_log10()+
  labs(title = "Mammal vs Birds Comparison of Average Home Range ")
  
 
 
```

**10. Do one additional exploratory analysis of your choice. Before writing the code, write the question you are trying to answer. The question should be biologically meaningful and appropriate for the data. It must include at least one `filter()`, `select()`, and `arrange()`.**
```{r}
  # Question I am trying to answer is if there is a pattern of  freshwater aquatic animals will have smaller home ranges than their terrestrial counterparts, on the theory that they cannot cross landmasses to new waterways the way terrestrial animals can cross waterways to new landmasses

 homerange %>% 
   select(common.name, taxon, locomotion, mean.hra.m2) %>% 
  filter(taxon!="marine fishes") %>% 
  arrange(mean.hra.m2)
  
  
  #The data set clearly shows that the average freshwater fishes homerange is most predominate at the bottom of the charts, meaning that they do  end to have smaller homeranges compared to animals that walk or fly. This can prove useful when thinking about freshwater fish conservation since they tend to have smaller homeranges and have less wiggle room for habitat destruction since they don't have much room to begin with.
 
```

## Knit and Upload
Please knit your work as an .html file and upload to Canvas. Homework is due before the start of the next lab. No late work is accepted. Make sure to use the formatting conventions of RMarkdown to make your report neat and clean!  